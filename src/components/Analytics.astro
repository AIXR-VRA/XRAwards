---
/**
 * Analytics component - supports Google Analytics and Plausible
 * Add this to your Layout head slot
 * Set PUBLIC_GA_MEASUREMENT_ID or PUBLIC_PLAUSIBLE_DOMAIN in .env
 */

const GA_ID = import.meta.env.PUBLIC_GA_MEASUREMENT_ID;
const PLAUSIBLE_DOMAIN = import.meta.env.PUBLIC_PLAUSIBLE_DOMAIN;
---

{GA_ID && (
  <>
    <!-- Google Analytics -->
    <script async src={`https://www.googletagmanager.com/gtag/js?id=${GA_ID}`}></script>
    <script is:inline define:vars={{ GA_ID }}>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', GA_ID);
    </script>
  </>
)}

{PLAUSIBLE_DOMAIN && (
  <!-- Plausible Analytics -->
  <script defer data-domain={PLAUSIBLE_DOMAIN} src="https://plausible.io/js/script.js"></script>
)}

{!GA_ID && !PLAUSIBLE_DOMAIN && (
  <!-- Analytics not configured - add PUBLIC_GA_MEASUREMENT_ID or PUBLIC_PLAUSIBLE_DOMAIN to .env -->
)}
